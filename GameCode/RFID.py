import board
import busio
from digitalio import DigitalInOut
from adafruit_pn532.spi import PN532_SPI


spi = busio.SPI(board.SCK, board.MOSI, board.MISO)
cs_pin = DigitalInOut(board.D5)
pn532 = PN532_SPI(spi, cs_pin, debug=False)

pn532.SAM_configuration()

cards = [
['0x4', '0xAD', '0x23', '0x8A', '0x2', '0x6C', '0x84'],
['0x4', '0xF4', '0xBF', '0x9A', '0x77', '0x6B', '0x80'],
['0x4', '0x82', '0x3C', '0x8A', '0x2', '0x6C', '0x84'],
['0x4', '0xDA', '0x1E', '0x8A', '0x2', '0x6C', '0x84'],
['0x4', '0xD1', '0x3C', '0x8A', '0x2', '0x6C', '0x84'],
['0x4', '0x88', '0x1F', '0x8A', '0x2', '0x6C', '0x84'],
['0x4', '0xEA', '0x39', '0x8A', '0x2', '0x6C', '0x84'],
['0x4', '0xC8', '0xF3', '0x12', '0x33', '0x6B', '0x80'],
['0x4', '0x2C', '0xE8', '0x12', '0x33', '0x6B', '0x80'],
['0x4', '0x8D', '0x3A', '0x8A', '0x2', '0x6C', '0x84'],
['0x4', '0x35', '0xCA', '0x9A', '0x77', '0x6B', '0x81'],
['0x4', '0x3A', '0xCC', '0x9A', '0x77', '0x6B', '0x80'],
['0x4', '0x43', '0xCA', '0x9A', '0x77', '0x6B', '0x80'],
['0x4', '0x30', '0xCA', '0x9A', '0x77', '0x6B', '0x81'],
['0x4', '0xF4', '0xB8', '0x9A', '0x77', '0x6B', '0x80'],
['0x4', '0xA4', '0xCD', '0x9A', '0x77', '0x6B', '0x80'],
['0x4', '0xFB', '0xB5', '0x9A', '0x77', '0x6B', '0x80'],
['0x4', '0xF9', '0xC3', '0x9A', '0x77', '0x6B', '0x80'],
['0x4', '0xD9', '0xCA', '0x9A', '0x77', '0x6B', '0x80'],
['0x4', '0xE4', '0xBA', '0x9A', '0x77', '0x6B', '0x80'],
['0x4', '0xFC', '0xC3', '0x9A', '0x77', '0x6B', '0x80'],
['0x4', '0x65', '0xC6', '0x9A', '0x77', '0x6B', '0x81'],
['0x4', '0x2F', '0xC4', '0x9A', '0x77', '0x6B', '0x80'],
['0x4', '0xFE', '0xF1', '0x12', '0x33', '0x6B', '0x80'],
['0x4', '0x8', '0xB5', '0x9A', '0x77', '0x6B', '0x81'],
['0x4', '0x34', '0xC1', '0x9A', '0x77', '0x6B', '0x80'],
['0x4', '0x77', '0xB6', '0x9A', '0x77', '0x6B', '0x81'],
['0x4', '0xCB', '0x2B', '0x8A', '0x2', '0x6C', '0x84'],
['0x4', '0x4A', '0x2A', '0x8A', '0x2', '0x6C', '0x85'],
['0x4', '0x13', '0x47', '0x8A', '0x2', '0x6C', '0x85'],
['0x4', '0x87', '0x3B', '0x8A', '0x2', '0x6C', '0x84'],
['0x4', '0xC0', '0x37', '0x8A', '0x2', '0x6C', '0x84'],
['0x4', '0xE2', '0x39', '0x8A', '0x2', '0x6C', '0x84'],
['0x4', '0x31', '0x2A', '0x8A', '0x2', '0x6C', '0x85'],
['0x4', '0xBA', '0x37', '0x8A', '0x2', '0x6C', '0x84'],
['0x4', '0x19', '0x47', '0x8A', '0x2', '0x6C', '0x85'],
['0x4', '0x95', '0xC0', '0x9A', '0x77', '0x6B', '0x80'],
['0x4', '0xB', '0xB5', '0x9A', '0x77', '0x6B', '0x81'],
['0x4', '0x49', '0xBF', '0x9A', '0x77', '0x6B', '0x81'],
['0x4', '0x5D', '0xCB', '0x9A', '0x77', '0x6B', '0x80'],
['0x4', '0x48', '0xEB', '0x12', '0x33', '0x6B', '0x80'],
['0x4', '0x27', '0x23', '0x8A', '0x2', '0x6C', '0x85'],
['0x4', '0xFD', '0xB8', '0x9A', '0x77', '0x6B', '0x80'],
['0x4', '0x9', '0xBF', '0x9A', '0x77', '0x6B', '0x81'],
['0x4', '0xC7', '0xBA', '0x9A', '0x77', '0x6B', '0x80'],
['0x4', '0xFA', '0xB8', '0x9A', '0x77', '0x6B', '0x80'],
['0x4', '0x77', '0xCF', '0x9A', '0x77', '0x6B', '0x81'],
['0x4', '0xD0', '0xCE', '0x9A', '0x77', '0x6B', '0x80'],
['0x4', '0x63', '0xED', '0x12', '0x33', '0x6B', '0x81'],
['0x4', '0x56', '0xB5', '0x9A', '0x77', '0x6B', '0x81'],
['0x4', '0x78', '0xC2', '0x9A', '0x77', '0x6B', '0x80'],
['0x4', '0x92', '0xB6', '0x9A', '0x77', '0x6B', '0x80'],
]

names = ["2C", "AC", "3C", "4C", "5C", "6C", "7C", "8C", "9C", "10C", "JC", "QC", "KC", "AH", "2H", "3H", "4H", "5H", "6H", "7H", "8H", "9H", "10H", "JH", "QH", "KH", "AS", "2S", "3S", "4S", "5S", "6S", "7S", "8S", "9S", "10S", "JS", "QS", "KS", "AD", "2D", "3D", "4D", "5D", "6D", "7D", "8D", "9D", "10D", "JD", "QD", "KD"]

def read():
    print("Waiting for card...")
    while True:
        uid = pn532.read_passive_target(timeout=0.5)
        if uid is None:
            continue
        card = [hex(i) for i in uid]
        break
    #print(card)
    for i, x in enumerate(cards):
        cards_lower = []
        for y in x:
            cards_lower.append(y.lower())
        if card == cards_lower:
            return(names[i])
